<%- contentFor('meta') %>
    <meta name="description" content="<%= produto.descricao_seo %>">
    <meta property="og:title" content="<%= titulo %>">
    <meta property="og:description" content="<%= produto.descricao_seo %>">
    <meta property="og:type" content="product">
    <meta property="og:url" content="<%= BASE_URL %>/peixe/<%= produto.slug %>">
    <meta property="og:image" content="<%= BASE_URL %><%= produto.imagem %>">
    <meta name="twitter:card" content="summary_large_image">

    <%- contentFor('script') %>
        <% const sku=produto.slug.toUpperCase(); const precoMinimo=Math.min(...Object.values(produto.preco_por_peso));
            const precoMaximo=Math.max(...Object.values(produto.preco_por_peso)); const productSchema={ "@context"
            : "https://schema.org/" , "@type" : "Product" , "name" : produto.nome, "image" : BASE_URL +
            produto.imagem, "description" : produto.descricao_seo, "sku" : sku, "offers" : { "@type" : "AggregateOffer"
            , "url" : BASE_URL + "/peixe/" + produto.slug, "priceCurrency" : "BRL" , "lowPrice" :
            precoMinimo, "highPrice" : precoMaximo, "availability" : produto.em_estoque ? "https://schema.org/InStock"
            : "https://schema.org/OutOfStock" } }; %>
            <script type="application/ld+json">
<%- JSON.stringify(productSchema) %>
</script>

            <%- contentFor('body') %>
                <div class="w-full bg-white flex-grow pt-8 pb-16">
                    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">

                        <!-- Breadcrumb e Voltar -->
                        <nav aria-label="Breadcrumb" class="mb-6">
                            <a href="/#produtos"
                                class="text-esmeralda hover:text-marinho font-medium transition-colors text-sm flex items-center gap-1">
                                &larr; Voltar ao Cat√°logo
                            </a>
                        </nav>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-10 lg:gap-16">

                            <!-- Imagem do Produto -->
                            <div
                                class="relative w-full aspect-square md:aspect-[4/3] bg-slate-100 rounded-2xl overflow-hidden shadow-sm">
                                <img src="<%= produto.imagem %>" alt="<%= produto.nome %>"
                                    class="w-full h-full object-cover">
                                <% if (!produto.contem_gluten) { %>
                                    <div class="absolute top-4 left-4 bg-ambar text-marinho px-4 py-1.5 text-sm font-bold rounded-full shadow"
                                        aria-label="Produto sem gl√∫ten">
                                        Sem Gl√∫ten
                                    </div>
                                    <% } %>
                            </div>

                            <!-- Detalhes e Compra -->
                            <div class="flex flex-col justify-center">
                                <div class="mb-3">
                                    <span
                                        class="inline-block px-3 py-1 bg-slate-100 text-slate-600 text-xs font-bold uppercase tracking-widest rounded-full">
                                        <%= produto.categoria==='couro' ? 'üêü Peixe de Couro' :
                                            (produto.categoria==='escama' ? 'üê† Peixe de Escama' : 'ü¶ê Frutos do Mar' )
                                            %>
                                    </span>
                                </div>

                                <h1
                                    class="font-titulo text-3xl md:text-4xl font-extrabold text-marinho mb-4 leading-tight">
                                    <%= produto.nome %>
                                </h1>

                                <p class="text-lg text-slate-600 mb-8 leading-relaxed">
                                    <%= produto.descricao_longa %>
                                </p>

                                <!-- Tabela de Pre√ßos -->
                                <div class="bg-slate-50 border border-slate-200 rounded-xl p-6 mb-8">
                                    <h3
                                        class="font-titulo font-bold text-slate-800 mb-4 uppercase text-sm tracking-wider">
                                        Tamanhos Dispon√≠veis</h3>
                                    <ul class="space-y-3">
                                        <% Object.entries(produto.preco_por_peso).forEach(([peso, preco])=> { %>
                                            <li
                                                class="flex justify-between items-center py-2 border-b border-slate-200 last:border-0 last:pb-0">
                                                <span class="font-medium text-slate-700 text-lg">
                                                    <%= peso %>
                                                </span>
                                                <span class="font-bold text-xl text-marinho">
                                                    <%= formatters.formatCurrency(preco) %>
                                                </span>
                                            </li>
                                            <% }) %>
                                    </ul>
                                </div>

                                <!-- Modo de Preparo Curto -->
                                <div class="mb-8 p-5 bg-amber-50 rounded-xl border border-amber-100">
                                    <div class="flex items-start gap-3">
                                        <span class="text-xl">‚ùÑÔ∏è</span>
                                        <div>
                                            <h4 class="font-bold text-amber-900 text-sm mb-1 uppercase tracking-wider">
                                                Como
                                                Fritar</h4>
                                            <p class="text-sm text-amber-800 leading-relaxed">
                                                <%= produto.instrucoes %>
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <% let msgUrl=getData().config.whatsapp_mensagem_padrao.replace('{produto}',
                                    produto.nome); let
                                    waUrl=`https://wa.me/${getData().config.whatsapp}?text=${encodeURIComponent(msgUrl)}`;
                                    %>

                                    <% if (produto.em_estoque) { %>
                                        <a href="<%= waUrl %>" target="_blank" rel="noopener noreferrer"
                                            class="w-full sm:w-auto bg-esmeralda hover:bg-emerald-700 text-white text-center font-bold text-lg py-4 px-8 rounded-xl shadow-md hover:shadow-lg transition-all transform hover:-translate-y-0.5 min-h-[56px] flex items-center justify-center gap-2">
                                            <span>Consultar Disponibilidade no WhatsApp</span>
                                        </a>
                                        <% } else { %>
                                            <div
                                                class="w-full sm:w-auto bg-slate-200 text-slate-500 text-center font-bold text-lg py-4 px-8 rounded-xl cursor-not-allowed">
                                                Produto Temporariamente Sem Estoque
                                            </div>
                                            <% } %>

                            </div>
                        </div>
                    </div>
                </div>